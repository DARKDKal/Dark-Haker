<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
    import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBImnR0ZRlIElw-Ao-ssi8CjscqiLm6Wa8",
        authDomain: "dark-haker.firebaseapp.com",
        databaseURL: "https://dark-haker-default-rtdb.firebaseio.com",
        projectId: "dark-haker",
        storageBucket: "dark-haker.firebasestorage.app",
        messagingSenderId: "186612807780",
        appId: "1:186612807780:web:479f0949b59e8fcc584771",
        measurementId: "G-96JW44RLYE"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    function addApp() {
        const appName = document.getElementById('appName').value;
        const appDescription = document.getElementById('appDescription').value;
        const files = Array.from(document.querySelectorAll('#fileInputs input[type="file"]'))
            .map(input => input.files[0])
            .filter(file => file);

        if (appName && appDescription && files.length > 0) {
            const fileLinks = files.map(file => URL.createObjectURL(file)); // سيتم استبدال هذا عند رفع الملفات فعليًا

            // إعداد بيانات التطبيق
            const newApp = {
                name: appName,
                description: appDescription,
                files: fileLinks
            };

            // حفظ التطبيق في Firebase
            const appsRef = ref(database, 'apps');
            push(appsRef, newApp).then(() => {
                alert("تم إضافة التطبيق بنجاح!");
                // إعادة تعيين الحقول بعد الحفظ
                document.getElementById('appName').value = '';
                document.getElementById('appDescription').value = '';
                document.querySelectorAll('#fileInputs input[type="file"]').forEach(input => input.value = '');
            }).catch((error) => {
                alert("حدث خطأ أثناء إضافة التطبيق: " + error.message);
            });
        } else {
            alert("يرجى ملء جميع الحقول وإضافة ملف واحد على الأقل.");
        }
    }
</script>
